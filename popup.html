<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SEI Smart</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <main>
      <header class="top-bar">
        <div class="header-content">
          <h1>🧠 SEI Smart</h1>
          <p class="header-subtitle">Assistente inteligente para seus despachos</p>
        </div>
        <button
          id="openOptionsButton"
          type="button"
          class="icon-button"
          aria-label="Abrir configurações"
          title="Abrir configurações"
        >
          <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
            <path
              d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm8.94-3.5c0-.59-.05-1.17-.15-1.73l2.03-1.58a1 1 0 0 0 .24-1.32l-1.92-3.32a1 1 0 0 0-1.2-.45l-2.39.96a7.96 7.96 0 0 0-1.5-.87l-.36-2.55A1 1 0 0 0 14.75 1h-3.5a1 1 0 0 0-.99.84l-.36 2.55c-.54.21-1.05.48-1.53.8l-2.38-.95a1 1 0 0 0-1.2.45L2.88 7.01a1 1 0 0 0 .24 1.32l2.02 1.57c-.08.56-.14 1.15-.14 1.75s.05 1.19.14 1.75l-2.02 1.57a1 1 0 0 0-.24 1.32l1.92 3.32a1 1 0 0 0 1.2.45l2.38-.95c.48.32.99.59 1.53.8l.36 2.55a1 1 0 0 0 .99.84h3.5a1 1 0 0 0 .99-.84l.36-2.55c.53-.21 1.03-.48 1.5-.87l2.39.96a1 1 0 0 0 1.2-.45l1.92-3.32a1 1 0 0 0-.24-1.32l-2.03-1.58c.1-.56.15-1.14.15-1.73Z"
            />
          </svg>
        </button>
      </header>

      <div class="form-group">
        <div class="label-with-action">
          <label for="dispatchText">📄 Despacho Recebido</label>
          <button id="captureTextButton" type="button" class="capture-button" title="Capturar texto do documento aberto no SEI">
            📋 Capturar do SEI
          </button>
        </div>
        <textarea id="dispatchText" placeholder="Cole aqui o texto do despacho que você recebeu..."></textarea>
        
        <div id="captureSourceSection" class="capture-source-section" hidden>
          <label for="captureSourceTab">📥 Capturar de qual janela?</label>
          <select id="captureSourceTab" class="target-select">
            <option value="">Carregando janelas...</option>
          </select>
          <div class="capture-actions">
            <button id="confirmCaptureButton" type="button" class="btn-capture-confirm">
              ✅ Capturar
            </button>
            <button id="cancelCaptureButton" type="button" class="btn-capture-cancel">
              ❌ Cancelar
            </button>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="promptExtra">💡 Contexto Adicional (opcional)</label>
        <textarea
          id="promptExtra"
          placeholder="Adicione informações extras que devem ser consideradas na resposta (prazos, referências, observações...)"
        ></textarea>
      </div>

      <div class="actions">
        <button id="generateButton" type="button" class="primary-button">
          ✨ Gerar Resposta com IA
        </button>
        <button id="writeManuallyButton" type="button" class="secondary-button">
          ✍️ Escrever Manualmente
        </button>
      </div>

      <p id="statusMessage" role="status" aria-live="polite"></p>

      <section id="resultSection" hidden>
        <div class="result-header">
          <h2 id="resultTitle">✅ Resposta Sugerida</h2>
          <p class="edit-hint" id="resultHint">💡 Você pode editar o texto antes de usar</p>
        </div>
        <textarea id="responseText" class="response-textarea" placeholder="Digite ou cole seu texto aqui..."></textarea>
        
        <div class="form-group">
          <div class="label-with-action">
            <label for="targetTab">🎯 Janela de Destino</label>
            <button id="reloadTargetTabsButton" type="button" class="capture-button" title="Recarregar lista de janelas">
              🔄 Atualizar
            </button>
          </div>
          <select id="targetTab" class="target-select">
            <option value="">Detectar automaticamente</option>
          </select>
          <p class="field-hint">Selecione em qual janela do SEI deseja colar a resposta</p>
        </div>

        <button id="useResponseButton" type="button" class="use-button">
          📋 Usar esta resposta no despacho
        </button>
      </section>
    </main>
    <script type="module" src="popup.js"></script>
  </body>
</html>
