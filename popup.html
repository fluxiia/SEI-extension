<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SEI Smart</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <main>
      <header class="top-bar">
        <div class="header-content">
          <h1>🧠 SEI Smart</h1>
          <p class="header-subtitle">Assistente inteligente para seus despachos</p>
        </div>
      <div class="header-buttons">
        <button
          id="openCreditsButton"
          type="button"
          class="icon-button"
          aria-label="Ver créditos"
          title="Ver créditos"
        >
          <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
            <path
              d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
            />
          </svg>
        </button>
        <button
          id="openOptionsButton"
          type="button"
          class="icon-button"
          aria-label="Abrir configurações"
          title="Abrir configurações"
        >
          <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
            <path
              d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm8.94-3.5c0-.59-.05-1.17-.15-1.73l2.03-1.58a1 1 0 0 0 .24-1.32l-1.92-3.32a1 1 0 0 0-1.2-.45l-2.39.96a7.96 7.96 0 0 0-1.5-.87l-.36-2.55A1 1 0 0 0 14.75 1h-3.5a1 1 0 0 0-.99.84l-.36 2.55c-.54.21-1.05.48-1.53.8l-2.38-.95a1 1 0 0 0-1.2.45L2.88 7.01a1 1 0 0 0 .24 1.32l2.02 1.57c-.08.56-.14 1.15-.14 1.75s.05 1.19.14 1.75l-2.02 1.57a1 1 0 0 0-.24 1.32l1.92 3.32a1 1 0 0 0 1.2.45l2.38-.95c.48.32.99.59 1.53.8l.36 2.55a1 1 0 0 0 .99.84h3.5a1 1 0 0 0 .99-.84l.36-2.55c.53-.21 1.03-.48 1.5-.87l2.39.96a1 1 0 0 0 1.2-.45l1.92-3.32a1 1 0 0 0-.24-1.32l-2.03-1.58c.1-.56.15-1.14.15-1.73Z"
            />
          </svg>
        </button>
      </div>
      </header>

      <div class="document-type-section">
        <div class="document-type-selector">
          <label class="toggle-option">
            <input type="radio" name="documentType" value="response" checked>
            <span class="toggle-text">
              <span class="toggle-label"> 📄 Resposta a Documento</span>
              <span class="toggle-description">Responder a um despacho recebido</span>
            </span>
          </label>
          <label class="toggle-option">
            <input type="radio" name="documentType" value="new">
            <span class="toggle-text">
              <span class="toggle-label">✨ Novo Documento</span>
              <span class="toggle-description">Criar documento do zero</span>
            </span>
          </label>
        </div>
      </div>

      <div class="form-group" id="responseModeFields">     
        <div id="captureSourceSection" class="capture-source-section" hidden>
          <div style="display: flex; align-items: center;">
            <label for="captureSourceTab" style="margin-bottom: 0; flex: 1;">📥 Capturar de qual janela?</label>
            <button id="captureTextButton" type="button" class="capture-button" style="margin-left: auto; margin-top: 8px;">
              📸 Capturar Lista de Janelas
            </button>
          </div>

          <select id="captureSourceTab" class="target-select">
            <option value="">Carregando janelas...</option>
          </select>
          <div class="capture-actions">
            <button id="confirmCaptureButton" type="button" class="btn-capture-confirm">
              ✅ Capturar Texto do Documento
            </button>
          </div>
          <div class="form-group">
            <label for="dispatchText">📄 Texto do Documento Recebido</label>
            <textarea id="dispatchText" 
            placeholder="Cole aqui o texto do despacho que você recebeu..." rows="4"></textarea>
          </div>
        </div>
      </div>


      <div class="form-group" id="documentModelGroup">
        <label for="documentModelSelect">📝 Modelo de Documento</label>
        <div class="custom-select-container">
          <select id="documentModelSelect" class="document-model-select">
            <option value="despacho-padrao">📄 Despacho Padrão</option>
            <option value="oficio-padrao">📋 Ofício Padrão</option>
            <option value="memorando-padrao">📝 Memorando Padrão</option>
          </select>
          <div class="select-arrow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </div>
        </div>
        <div class="model-preview" id="modelPreview">
          <div class="preview-header">
            <span class="preview-label">👁️ Preview do Modelo:</span>
            <button type="button" class="preview-toggle" id="previewToggle">🔽</button>
          </div>
          <div class="preview-content" id="previewContent" style="display: none;">
            <pre id="previewText">Carregando preview...</pre>
          </div>
        </div>
        <p class="field-hint">Escolha o modelo que melhor se adequa ao seu documento</p>
      </div>      

      <div class="form-group" id="documentNameGroup">
        <label for="documentName">📋 Nome do Documento (opcional)</label>
        <input
          type="text"
          id="documentName"
          placeholder="Ex: DESPACHO 123/STC"
        />
        <p class="field-hint">Nome/título do documento que será gerado</p>
      </div>

      <div class="form-group" id="newDocumentFields" style="display: none;">
        <div class="form-group">
        <label for="newDocumentContext">📝 Contexto do Novo Documento</label>
        <div style="display: flex; align-items: flex-start; gap: 8px;">
          <button id="fillContextExampleButton" type="button" class="icon-button" title="Preencher com exemplo padrão" style="margin-bottom: 8px; margin-right: 6px; align-self: flex-start;">
            <span style="font-size: 1.1em;">✨</span>
          </button>
          <textarea
            id="newDocumentContext"
            placeholder="Descreva o contexto do novo documento:

Exemplo:
Situação: Processo administrativo sobre licitação
Destinatário: Secretaria de Administração
Objetivo: Solicitar esclarecimentos sobre documentação
Contexto: O processo 12345/2024 foi protocolado com documentos incompletos. Necessário solicitar complementação da documentação fiscal e técnica.
Prazo: 30 dias"
            rows="5"
            style="flex: 1;"
          ></textarea>
        </div>
        </div>
        <p class="field-hint">Descreva detalhadamente a situação, destinatário, objetivo e contexto do documento</p>
      </div>

      <div class="form-group" id="additionalContextFields">
        <label for="promptExtra">💡 Contexto Adicional (opcional)</label>
        <textarea
          id="promptExtra"
          placeholder="Adicione informações extras que devem ser consideradas (prazos, referências, observações...)"
          rows="3"
        ></textarea>
      </div>

      <div class="actions">
        <button id="generateButton" type="button" class="primary-button">
          ✨ Gerar Texto Sugerido com IA
        </button>
        <button id="writeManuallyButton" type="button" class="secondary-button">
          ✍️ Escrever Manualmente
        </button>
      </div>

      <p id="statusMessage" role="status" aria-live="polite"></p>

      <section id="resultSection" hidden>
        <div class="result-header">
          <h2 id="resultTitle">✅ Resposta Sugerida</h2>
          <p class="edit-hint" id="resultHint">💡 Você pode editar o texto antes de usar</p>
        </div>
        <textarea id="responseText" class="response-textarea" placeholder="Digite ou cole seu texto aqui..."></textarea>
        
        <div class="form-group">
          <div class="label-with-action">
            <label for="targetTab">🎯 Janela de Destino</label>
            <button id="reloadTargetTabsButton" type="button" class="capture-button" title="Recarregar lista de janelas">
              🔄 Atualizar
            </button>
          </div>
          <select id="targetTab" class="target-select">
            <option value="">Detectar automaticamente</option>
          </select>
          <p class="field-hint">Selecione em qual janela do SEI deseja colar a resposta</p>
        </div>

        <button id="useResponseButton" type="button" class="use-button">
          📋 Usar esta resposta no despacho
        </button>
      </section>

      <!-- Modal de Créditos -->
      <div id="creditsModal" class="modal-overlay" hidden>
        <div class="modal-content">
          <div class="modal-header">
            <h2>🎉 Créditos - SEI Smart</h2>
            <button id="closeCreditsButton" class="close-button" aria-label="Fechar">
              <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
                <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
              </svg>
            </button>
          </div>
          <div class="modal-body">
            <div class="credits-content">
              <div class="developer-info">
                <div class="avatar">
                  <div class="avatar-circle">
                    <span class="avatar-text">SF</span>
                  </div>
                </div>
                <div class="developer-details">
                  <h3>Steferson Ferreira</h3>
                  <p class="developer-role">Desenvolvedor & Criador</p>
                  <div class="contact-info">
                    <a href="mailto:steferson.ferreira@gmail.com" class="contact-link">
                      <svg viewBox="0 0 24 24" class="contact-icon">
                        <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                      </svg>
                      steferson.ferreira@gmail.com
                    </a>
                  </div>
                </div>
              </div>
              
              <div class="project-info">
                <h4>🚀 Sobre o SEI Smart</h4>
                <p>Uma extensão inteligente que utiliza IA para automatizar e otimizar a criação de documentos administrativos no Sistema Eletrônico de Informações (SEI).</p>
                
                <div class="features-list">
                  <div class="feature-item">
                    <span class="feature-icon">🤖</span>
                    <span>Geração automática de despachos com IA</span>
                  </div>
                  <div class="feature-item">
                    <span class="feature-icon">📄</span>
                    <span>Modelos personalizados de documentos</span>
                  </div>
                  <div class="feature-item">
                    <span class="feature-icon">📸</span>
                    <span>Captura automática de texto</span>
                  </div>
                  <div class="feature-item">
                    <span class="feature-icon">⚡</span>
                    <span>Interface otimizada e intuitiva</span>
                  </div>
                </div>
              </div>

              <div class="version-info">
                <p class="version-text">Versão 1.0.0</p>
                <p class="copyright-text">© 2025 SEI Smart. Todos os direitos reservados.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <script type="module" src="popup.js"></script>
  </body>
</html>
